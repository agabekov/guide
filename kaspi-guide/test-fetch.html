<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Test Fetch</title>
</head>
<body>
    <h1>Test Groq API Fetch</h1>
    <button onclick="testFetch()">Test Fetch</button>
    <div style="margin: 8px 0;">
      <label for="apiKey">Groq API Key:</label>
      <input id="apiKey" type="password" style="width: 420px;" placeholder="Paste VITE_GROQ_API_KEY value" />
    </div>
    <div id="result"></div>

    <script>
        async function testFetch() {
            const apiKey = document.getElementById('apiKey').value.trim();
            const resultDiv = document.getElementById('result');

            if (!apiKey) {
                resultDiv.innerHTML = '<p style="color: red;">Добавьте API ключ</p>';
                return;
            }

            try {
                resultDiv.innerHTML = 'Testing...';

                const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        model: 'llama-3.3-70b-versatile',
                        messages: [
                            {
                                role: 'user',
                                content: 'Привет! Сгенерируй один вопрос на русском языке о Kaspi.kz'
                            }
                        ],
                        temperature: 0.7,
                        max_tokens: 100,
                    }),
                });

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(`API Error: ${response.status} - ${JSON.stringify(errorData)}`);
                }

                const data = await response.json();
                resultDiv.innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
            } catch (error) {
                resultDiv.innerHTML = '<p style="color: red;">Error: ' + error.message + '</p>';
                console.error('Full error:', error);
            }
        }
    </script>
</body>
</html>
